# Codeml LRT (Likelihood Ratio Test)

This Python package performs likelihood ratio tests (LRT) to assist in model selection for results generated by PAML's codeml.

## Installation

To install this package, clone the repository and navigate into the project's directory:

```shell
git clone https://gitlab.gwdg.de/clemens.mauksch/codeml_lrt
cd codeml_lrt
```

Then, install the package with pip:

```shell
pip install .
```

## Usage

Once installed, the package provides a command-line script `codeml-lrt` which you can run as follows:

```shell
codeml-lrt --H0_dir /path/to/H0_dir --H1_dir /path/to/H1_dir
```

Both arguments `--H0_dir` and `--H1_dir` are optional, and if not provided, they will default to `/default/path/to/H0_dir` and `/default/path/to/H1_dir`, respectively. Replace these with the actual paths where your results for the null model and the alternative model are stored.

You can also use the package in Python scripts:

```python
from codeml_lrt import read_control_file, likelihood_ratio_test

# Read data from control files
model_H0, df_H0, lnL_H0 = read_control_file('/path/to/H0_dir')
model_H1, df_H1, lnL_H1 = read_control_file('/path/to/H1_dir')

# Perform the likelihood ratio test
p_value = likelihood_ratio_test(lnL_H0, lnL_H1, df_H0, df_H1)
```

## Directory Structure for Results

The directory for results should be structured such that each directory's name corresponds to the name of the codeml output file without the `_out.paml` extension. Within each directory, the `codeml.ctl` file and the `{directory_name}_out.paml` file are expected to be present.

For instance, if your codeml output file is named `model1_out.paml`, there should be a directory named `model1` containing `codeml.ctl` and `model1_out.paml`.
